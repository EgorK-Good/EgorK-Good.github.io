<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-Frame Game</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <a-scene physics="debug: false">
        <!-- Небо и пол -->
        <a-sky color="#7BC8A4"></a-sky>
        <a-plane position="0 0 0" rotation="-90 0 0" width="100" height="100" color="#7BC8A4" static-body></a-plane>

        <!-- Камера и контроллер с id "player" -->
        <a-entity id="player" camera look-controls wasd-controls position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-entity>

        <!-- Объекты для сбора -->
        <a-box id="collectible1" position="2 1 -3" color="#4CC3D9" dynamic-body collectible></a-box>
        <a-sphere id="collectible2" position="-2 1 -3" radius="0.5" color="#EF2D5E" dynamic-body collectible></a-sphere>

        <!-- Текст счета в центре -->
        <a-text id="scoreText" value="Score: 0" position="-2 2 -5"></a-text>
    </a-scene>

    <script>
        // Логика сбора объектов
        AFRAME.registerComponent('collectible', {
            init: function () {
                this.el.addEventListener('collide', (e) => {
                    if (e.detail.body.el.id === 'player') {
                        updateScore(); // Обновить счет
                        respawnCollectible(this.el); // Переместить объект в случайное место
                    }
                });
            }
        });

        let score = 0;

        function updateScore() {
            score += 1; // Увеличиваем счет на 1
            document.querySelector('#scoreText').setAttribute('value', 'Score: ' + score); // Обновляем текст счета
            console.log('Score updated:', score); // Логируем обновление счета для отладки
        }

        function respawnCollectible(collectible) {
            const x = (Math.random() - 0.5) * 20; // Генерируем случайную позицию x
            const z = (Math.random() - 0.5) * 20; // Генерируем случайную позицию z
            collectible.setAttribute('position', { x: x, y: 1, z: z }); // Устанавливаем новую позицию
            collectible.setAttribute('visible', true); // Делаем объект видимым
            console.log('Collectible respawned at:', { x, y: 1, z }); // Логируем новое положение объекта для отладки
        }
    </script>
</body>
</html>
