<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VR Mini Game</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
    <a-scene>
        <!-- Небо -->
        <a-sky color="#ECECEC"></a-sky>

        <!-- Пол -->
        <a-plane position="0 0 -4" rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>

        <!-- Камера и контроллер -->
        <a-entity camera look-controls position="0 1.6 0" id="player"></a-entity>

        <!-- Объекты для сбора -->
        <a-box position="-1 0.5 -3" rotation="0 45 45" color="#4CC3D9" class="collectible"></a-box>
        <a-sphere position="1 1.25 -5" radius="1.25" color="#EF2D5E" class="collectible"></a-sphere>
        <a-cylinder position="0 0.75 -5" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>

        <!-- Текст для отображения счета -->
        <a-text id="scoreText" value="Score: 0" position="-1.5 2.5 -5" color="black"></a-text>

        <!-- Таймер -->
        <a-text id="timerText" value="Time: 60" position="1.5 2.5 -5" color="black"></a-text>
    </a-scene>

    <script>
        // Переменные для счета и таймера
        let score = 0;
        let timeLeft = 60;

        // Получаем элементы текста
        const scoreText = document.getElementById('scoreText');
        const timerText = document.getElementById('timerText');

        // Функция обновления счета
        function updateScore() {
            score++;
            scoreText.setAttribute('value', 'Score: ' + score);
        }

        // Функция обновления таймера
        function updateTimer() {
            if (timeLeft > 0) {
                timeLeft--;
                timerText.setAttribute('value', 'Time: ' + timeLeft);
            } else {
                clearInterval(timerInterval);
                alert('Время вышло! Ваш итоговый счет: ' + score);
            }
        }

        // Создание компонента для обработки столкновений
        AFRAME.registerComponent('collidable', {
            init: function () {
                this.el.addEventListener('collide', (event) => {
                    if (event.detail.body.el.id === 'player') {
                        // Увеличиваем счет и убираем объект
                        updateScore();
                        this.el.parentNode.removeChild(this.el); // Удаляем объект из сцены
                    }
                });
            }
        });

        // Устанавливаем обработчики событий для объектов
        const collectibles = document.querySelectorAll('.collectible');
        collectibles.forEach(item => {
            item.setAttribute('collidable', ''); // Добавляем компонент столкновения
        });

        // Запускаем таймер
        const timerInterval = setInterval(updateTimer, 1000);
    </script>
</body>
</html>
