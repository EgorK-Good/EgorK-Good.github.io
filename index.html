<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-Frame Game</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <a-scene physics="debug: false">
        <!-- Небо и пол -->
        <a-assets>
            <img id="sky" src="sky.png">
            <img id="ground" src="ret.png">
            <a-asset-item id="my-model" src="https://example.com/path/to/your/model.glb"></a-asset-item>
        </a-assets>
        <a-sky src="#sky"></a-sky>
        <a-plane position="0 0 0" rotation="-90 0 0" width="100" height="100" color="#7BC8A4" src="#ground" static-body></a-plane>

        <!-- Камера и контроллер с id "player" -->
        <a-entity id="player" camera look-controls wasd-controls="acceleration:100" position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-entity>

        <!-- Объекты для сбора -->
        <a-box id="collectible1" position="2 1 -3" color="#4CC3D9" dynamic-body collectible></a-box>
        <a-sphere id="collectible2" position="-2 1 -3" radius="0.5" color="#EF2D5E" dynamic-body collectible></a-sphere>
        <a-cylinder id="collectible3" position="0 1 -5" radius="0.5" height="1" color="#FFC65D" dynamic-body collectible></a-cylinder>
        <a-torus id="collectible4" position="3 1 -7" radius="0.5" radius-tubular="0.2" color="#7D3C98" dynamic-body collectible></a-torus>
        <a-ring id="collectible5" position="-3 1 -7" radius-inner="0.2" radius-outer="0.5" color="#F7DC6F" dynamic-body collectible></a-ring>

        <!-- Текст счета в центре -->
        <a-text id="scoreText" value="Score: 0" position="-2 2 -5"></a-text>

        <!-- Таймер -->
        <a-text id="timerText" value="Time: 60" position="2 2 -5"></a-text>

        <!-- 3D модель -->
        <a-entity gltf-model="#my-model" position="0 1 -7"></a-entity>
    </a-scene>

    <script>
        // Логика сбора объектов
        AFRAME.registerComponent('collectible', {
            init: function () {
                this.el.addEventListener('collide', (e) => {
                    if (e.detail.body.el.id === 'player') {
                        this.el.setAttribute('visible', false); // Скрыть объект
                        updateScore(); // Обновить счет
                        respawnCollectible(this.el); // Переместить объект в случайное место
                    }
                });
            }
        });

        let score = 0;

        function updateScore() {
            score += 1; // Увеличиваем счет на 1
            document.querySelector('#scoreText').setAttribute('value', 'Score: ' + score); // Обновляем текст счета
        }

        function respawnCollectible(collectible) {
            const x = (Math.random() - 0.5) * 20; // Генерируем случайную позицию x
            const z = (Math.random() - 0.5) * 20; // Генерируем случайную позицию z
            collectible.setAttribute('position', { x: x, y: 1, z: z }); // Устанавливаем новую позицию
            collectible.setAttribute('visible', true); // Делаем объект видимым
        }

        // Таймер
        let timeLeft = 60;
        let timerInterval = setInterval(() => {
            timeLeft -= 1;
            document.querySelector('#timerText').setAttribute('value', 'Time: ' + timeLeft);
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                endGame();
            }
        }, 1000);

        function endGame() {
            document.querySelector('#timerText').setAttribute('value', 'Game Over! Final Score: ' + score);
            setTimeout(() => {
                location.reload();
            }, 3000);
        }
    </script>
</body>
</html>
